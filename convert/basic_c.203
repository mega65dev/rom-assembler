sswe             jsr shpn                                 ; shift decimal point
                 jsr uround                               ; round number
                 jsr shpn                                 ; shift again if necessary

hup              +lbra chout                              ; output number



cff              ldy uexp                                 ; exponent in no?
                 beq _local_1202_20                       ; no...
                 sta hulp                                 ; delete exponent
                 sec                                      ; adjust decimal point
                 ror etof                                 ; set e-to-f flag
                 ldy point                                
                 lda usgn                                 ; exec nos3 or nos4
                 bpl _local_1202_10                       ; depends on sign of exp
                 jsr nos3                                 
                 bra _local_1202_30                       

_local_1202_10   jsr nos4                                 

_local_1202_20   ldy point                                ; at start of no?
                 beq _local_1202_30                       ; yes...
                 jsr cho                                  ; no = 0 ?
                 beq _local_1202_40                       ; yes...no round

_local_1202_30   jsr uround                               
                 bra _local_1202_50                       

_local_1202_40   dec vn                                   ; adjust...no was 0
_local_1202_50   sec                                      
                 lda vf                                   
                 sbc vn                                   
                 bcc errf                                 ; no fit...error
                 sta swe                                  ; save difference
                 ldy posp                                 ; + or -?
                 bne ahp                                  ; yes...
                 ldy sno                                  ; get sign
                 bmi ahp                                  ; positive...
                 tay                                      
                 beq errf                                 ; no room for sign
                 dey                                      
                 bne ldvn                                 ; swe<>1
                 lda nf                                   
                 ora vn                                   ; both zero?
                 bne hup                                  ; no...


